# è¿åŠ¨è…¿ç¯ç³»ç»Ÿ (Smart Sports Anklet System)

<div align="center">

![Python](https://img.shields.io/badge/Python-3.7+-blue.svg)
![Flask](https://img.shields.io/badge/Flask-2.0+-green.svg)
![License](https://img.shields.io/badge/License-MIT-yellow.svg)
![Status](https://img.shields.io/badge/Status-Active-success.svg)

ä¸€ä¸ªåŸºäºè¡Œç©ºæ¿M10çš„æ™ºèƒ½è¿åŠ¨è…¿ç¯ç³»ç»Ÿï¼Œæ”¯æŒå¤šç§è¿åŠ¨æ¨¡å¼ç›‘æµ‹ã€å¥åº·æ•°æ®è¿½è¸ªå’Œè¿œç¨‹æ§åˆ¶ã€‚

[åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§) â€¢ [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹) â€¢ [éƒ¨ç½²æ•™ç¨‹](#éƒ¨ç½²æ•™ç¨‹) â€¢ [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜) â€¢ [APIæ–‡æ¡£](#apiæ–‡æ¡£)

</div>

---

## ğŸ“‹ ç›®å½•

- [é¡¹ç›®ç®€ä»‹](#é¡¹ç›®ç®€ä»‹)
- [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
- [ç³»ç»Ÿæ¶æ„](#ç³»ç»Ÿæ¶æ„)
- [ç¡¬ä»¶éœ€æ±‚](#ç¡¬ä»¶éœ€æ±‚)
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [éƒ¨ç½²æ•™ç¨‹](#éƒ¨ç½²æ•™ç¨‹)
- [ä½¿ç”¨è¯´æ˜](#ä½¿ç”¨è¯´æ˜)
- [APIæ–‡æ¡£](#apiæ–‡æ¡£)
- [æ•…éšœæ’æŸ¥](#æ•…éšœæ’æŸ¥)
- [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
- [è®¸å¯è¯](#è®¸å¯è¯)

---

## é¡¹ç›®ç®€ä»‹

è¿åŠ¨è…¿ç¯ç³»ç»Ÿæ˜¯ä¸€ä¸ªé›†æˆäº†å¤šç§ä¼ æ„Ÿå™¨çš„æ™ºèƒ½å¯ç©¿æˆ´è®¾å¤‡ç›‘æ§ç³»ç»Ÿï¼Œé€šè¿‡è¡Œç©ºæ¿M10ç¡¬ä»¶å¹³å°å®ç°å®æ—¶æ•°æ®é‡‡é›†ã€å¥åº·ç›‘æµ‹å’Œè¿åŠ¨è¿½è¸ªåŠŸèƒ½ã€‚ç³»ç»Ÿé‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ï¼Œæä¾›Webæ§åˆ¶ç•Œé¢å’ŒRESTful APIæ¥å£ã€‚

### ä¸»è¦åŠŸèƒ½

- ğŸƒ **å¤šæ¨¡å¼è¿åŠ¨ç›‘æµ‹**ï¼šç”Ÿæ´»ã€è¿åŠ¨ã€éª‘è¡Œã€ä¼šè®®å››ç§æ¨¡å¼
- ğŸ“Š **å®æ—¶æ•°æ®é‡‡é›†**ï¼šæ¸©åº¦ã€æ¹¿åº¦ã€å§¿æ€ã€æ­¥æ•°ç­‰
- ğŸ¯ **å¥åº·æé†’**ï¼šä¹…åæé†’ã€è¿åŠ¨å»ºè®®ã€è·Œå€’æ£€æµ‹
- ğŸŒ **ç¢³å‡æ’ç»Ÿè®¡**ï¼šè¿åŠ¨å‡ç¢³é‡è®¡ç®—å’Œç´¯è®¡
- ğŸ“± **è¿œç¨‹æ§åˆ¶**ï¼šWebç•Œé¢å®æ—¶ç›‘æ§å’Œæ§åˆ¶
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šå†å²æ•°æ®å­˜å‚¨å’Œåˆ†æ
- ğŸ”Š **è¯­éŸ³æ’­æŠ¥**ï¼šå®æ—¶è¯­éŸ³åé¦ˆå’Œæé†’
- ğŸš¨ **ç´§æ€¥æ•‘æ´**ï¼šè·Œå€’æ£€æµ‹å’Œç´§æ€¥é€šçŸ¥

---

## åŠŸèƒ½ç‰¹æ€§

### 1. è¿åŠ¨æ¨¡å¼ç®¡ç†

#### ç”Ÿæ´»æ¨¡å¼ (MODE_LIFE)
- å§¿æ€ç›‘æµ‹ï¼ˆåå§¿/ç«™å§¿ï¼‰
- ä¹…åæ—¶é•¿ç»Ÿè®¡å’Œæé†’
- è·Œå€’æ£€æµ‹å’Œç´§æ€¥æŠ¥è­¦
- ç¯å¢ƒæ¸©æ¹¿åº¦ç›‘æµ‹

#### è¿åŠ¨æ¨¡å¼ (MODE_SPORT)
- å®æ—¶æ­¥æ•°ç»Ÿè®¡
- é…é€Ÿè®¡ç®—ï¼ˆåˆ†é’Ÿ/å…¬é‡Œï¼‰
- è¿åŠ¨æ—¶é•¿è®°å½•
- ç¢³å‡æ’é‡ä¼°ç®—
- å¡è·¯é‡Œæ¶ˆè€—è®¡ç®—

#### éª‘è¡Œæ¨¡å¼ (MODE_CYCLING)
- éª‘è¡Œé€Ÿåº¦ç›‘æµ‹
- é‡Œç¨‹ç»Ÿè®¡
- é…é€Ÿæ˜¾ç¤º
- ç¯å¢ƒæ•°æ®è®°å½•

#### ä¼šè®®æ¨¡å¼ (MODE_MEETING)
- å±å¹•é»‘å±èŠ‚èƒ½
- é™éŸ³æ¨¡å¼
- ä»…ä¿æŒæ•°æ®é‡‡é›†

### 2. æ•°æ®ç›‘æµ‹

| ä¼ æ„Ÿå™¨ç±»å‹ | ç›‘æµ‹å†…å®¹ | æ›´æ–°é¢‘ç‡ |
|-----------|---------|---------|
| DHT11 | æ¸©åº¦ã€æ¹¿åº¦ | 5ç§’ |
| åŠ é€Ÿåº¦è®¡ | å§¿æ€ã€è¿åŠ¨çŠ¶æ€ | å®æ—¶ |
| æ­¥æ•°ä¼ æ„Ÿå™¨ | æ­¥æ•°ç»Ÿè®¡ | å®æ—¶ |
| æŒ‰é’® | æ¨¡å¼åˆ‡æ¢ | å®æ—¶ |
| æ—‹é’® | LEDäº®åº¦è°ƒèŠ‚ | 100ms |

### 3. Webæ§åˆ¶ç•Œé¢

- ğŸ“± **å“åº”å¼è®¾è®¡**ï¼šè‡ªé€‚åº”æ‰‹æœºå’Œæ¡Œé¢ç«¯
- ğŸ“Š **å®æ—¶ä»ªè¡¨ç›˜**ï¼šè®¾å¤‡çŠ¶æ€ã€ç¯å¢ƒæ•°æ®ã€è¿åŠ¨ç»Ÿè®¡
- ğŸ“ˆ **å†å²æ•°æ®å¯è§†åŒ–**ï¼š7å¤©/30å¤©è¿åŠ¨è¶‹åŠ¿å›¾
- ğŸ›ï¸ **è¿œç¨‹æ§åˆ¶**ï¼šæ¨¡å¼åˆ‡æ¢ã€äº®åº¦è°ƒèŠ‚ã€æ¶ˆæ¯æ¨é€
- ğŸš¨ **ç´§æ€¥è®°å½•**ï¼šè·Œå€’äº‹ä»¶æŸ¥çœ‹å’Œå¤„ç†
- âš™ï¸ **è®¾ç½®ç®¡ç†**ï¼šä¹…åæé†’æ—¶é•¿è‡ªå®šä¹‰

### 4. æ•°æ®æŒä¹…åŒ–

```
data/
â”œâ”€â”€ emergency.json        # ç´§æ€¥äº‹ä»¶è®°å½•
â”œâ”€â”€ history.json          # å†å²è¿åŠ¨æ•°æ®
â”œâ”€â”€ sport_records.json    # è¿åŠ¨è®°å½•è¯¦æƒ…
â””â”€â”€ settings.json         # ç³»ç»Ÿè®¾ç½®
```

### 5. APIæ¥å£

å®Œæ•´çš„RESTful APIæ”¯æŒï¼Œè¯¦è§[APIæ–‡æ¡£](#apiæ–‡æ¡£)éƒ¨åˆ†ã€‚

---

## ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Web Browser                      â”‚
â”‚              (control.html - æ§åˆ¶ç•Œé¢)               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP/REST API
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Flask Server (server.py)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  REST API Endpoints                           â”‚  â”‚
â”‚  â”‚  - /api/status   - /api/control               â”‚  â”‚
â”‚  â”‚  - /api/history  - /api/emergency             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Data Storage                                 â”‚  â”‚
â”‚  â”‚  - JSON Files  - Command Queue                â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚ HTTP Polling (2s interval)
                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        è¡Œç©ºæ¿M10 Client (client.py)                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Hardware Control                             â”‚  â”‚
â”‚  â”‚  - DHT11  - LED Strip  - Button  - Knob      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Data Processing                              â”‚  â”‚
â”‚  â”‚  - Posture Detection  - Step Counting         â”‚  â”‚
â”‚  â”‚  - Pace Calculation   - Carbon Tracking       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  UI & Voice                                   â”‚  â”‚
â”‚  â”‚  - OLED Display  - TTS Voice Synthesis        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç¡¬ä»¶éœ€æ±‚

### å¿…éœ€ç¡¬ä»¶

| ç¡¬ä»¶ | å‹å· | ç”¨é€” |
|-----|------|-----|
| ä¸»æ§æ¿ | è¡Œç©ºæ¿M10 | ä¸»æ§åˆ¶å™¨ |
| æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ | DHT11 | ç¯å¢ƒç›‘æµ‹ |
| LEDç¯å¸¦ | WS2812 (7ç¯) | çŠ¶æ€æŒ‡ç¤º |
| æŒ‰é’® | æ™®é€šæŒ‰é’® | æ¨¡å¼åˆ‡æ¢ |
| æ—‹é’® | æ¨¡æ‹Ÿæ—‹é’® | äº®åº¦è°ƒèŠ‚ |
| è¯­éŸ³åˆæˆæ¨¡å— | DFRobotè¯­éŸ³åˆæˆ | è¯­éŸ³æ’­æŠ¥ |

### å¼•è„šè¿æ¥

```
DHT11      â†’ P23
Button     â†’ P24
Knob       â†’ P22 (æ¨¡æ‹Ÿ)
LED Strip  â†’ P21
```

### è½¯ä»¶ç¯å¢ƒ

- **å®¢æˆ·ç«¯ï¼ˆè¡Œç©ºæ¿M10ï¼‰**
  - Python 3.7+
  - MindPlus/è¡Œç©ºæ¿å¼€å‘ç¯å¢ƒ
  
- **æœåŠ¡å™¨**
  - Python 3.7+
  - Flask 2.0+
  - ä»»ä½•æ”¯æŒPythonçš„æ“ä½œç³»ç»Ÿ

---

## å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/binglang001/smart-sports-anklet.git
cd smart-sports-anklet
```

### 2. å®‰è£…æœåŠ¡å™¨ä¾èµ–

```bash
pip install -r requirements.txt
```

### 3. å¯åŠ¨æœåŠ¡å™¨

```bash
python server.py
```

æœåŠ¡å™¨å°†åœ¨ `http://0.0.0.0:5000` å¯åŠ¨ã€‚

### 4. é…ç½®å®¢æˆ·ç«¯

ç¼–è¾‘ `client.py` ä¸­çš„æœåŠ¡å™¨åœ°å€ï¼š

```python
SERVER_URL = "http://YOUR_SERVER_IP:5000"  # æ”¹ä¸ºè¿è¡ŒæœåŠ¡ç«¯çš„è®¾å¤‡çš„IP
```

### 5. éƒ¨ç½²åˆ°è¡Œç©ºæ¿

å°† `client.py` ä¸Šä¼ åˆ°è¡Œç©ºæ¿M10å¹¶è¿è¡Œã€‚

### 6. è¿æ¥åŒä¸€ç½‘ç»œ

å°†è¡Œç©ºæ¿ä¸æœåŠ¡å™¨è¿æ¥åˆ°åŒä¸€ç½‘ç»œ

### 7. è®¿é—®æ§åˆ¶ç•Œé¢

æœåŠ¡å™¨ä¸Šæµè§ˆå™¨æ‰“å¼€ï¼š`http://localhost:5000`

---

## éƒ¨ç½²æ•™ç¨‹

### æœåŠ¡å™¨éƒ¨ç½²ï¼ˆè¯¦ç»†æ­¥éª¤ï¼‰

#### Windowséƒ¨ç½²

1. **å®‰è£…Python**
   ```bash
   # ä¸‹è½½Python 3.7+
   # ä» https://www.python.org/downloads/ ä¸‹è½½å¹¶å®‰è£…
   ```

2. **åˆ›å»ºé¡¹ç›®ç›®å½•**
   ```bash
   mkdir smart-sports-anklet
   cd smart-sports-anklet
   ```

3. **ä¸‹è½½é¡¹ç›®æ–‡ä»¶**
   ```bash
   # å°† server.py, control.html, requirements.txt æ”¾å…¥ç›®å½•
   ```

4. **å®‰è£…ä¾èµ–**
   ```bash
   pip install -r requirements.txt
   ```

5. **å¯åŠ¨æœåŠ¡å™¨**
   ```bash
   python server.py
   ```

6. **éªŒè¯å®‰è£…**
   - æµè§ˆå™¨è®¿é—® `http://localhost:5000`
   - åº”è¯¥çœ‹åˆ°æ§åˆ¶ç•Œé¢

#### Linux/æ ‘è“æ´¾éƒ¨ç½²

1. **æ›´æ–°ç³»ç»Ÿ**
   ```bash
   sudo apt-get update
   sudo apt-get upgrade
   ```

2. **å®‰è£…Pythonå’Œpip**
   ```bash
   sudo apt-get install python3 python3-pip
   ```

3. **å…‹éš†æˆ–ä¸‹è½½é¡¹ç›®**
   ```bash
   git clone https://github.com/binglang001/smart-sports-anklet.git
   cd smart-sports-anklet
   ```

4. **å®‰è£…ä¾èµ–**
   ```bash
   pip3 install -r requirements.txt
   ```

5. **åå°è¿è¡ŒæœåŠ¡å™¨**
   ```bash
   nohup python3 server.py > server.log 2>&1 &
   ```

6. **è®¾ç½®å¼€æœºè‡ªå¯åŠ¨**ï¼ˆå¯é€‰ï¼‰
   ```bash
   # åˆ›å»ºsystemdæœåŠ¡
   sudo nano /etc/systemd/system/sports-anklet.service
   ```
   
   æ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š
   ```ini
   [Unit]
   Description=Smart Sports Anklet Server
   After=network.target
   
   [Service]
   Type=simple
   User=pi
   WorkingDirectory=/home/pi/smart-sports-anklet
   ExecStart=/usr/bin/python3 /home/pi/smart-sports-anklet/server.py
   Restart=always
   
   [Install]
   WantedBy=multi-user.target
   ```
   
   å¯ç”¨æœåŠ¡ï¼š
   ```bash
   sudo systemctl enable sports-anklet.service
   sudo systemctl start sports-anklet.service
   sudo systemctl status sports-anklet.service
   ```

### å®¢æˆ·ç«¯éƒ¨ç½²ï¼ˆè¡Œç©ºæ¿M10ï¼‰

1. **è¿æ¥ç¡¬ä»¶**
   - æŒ‰ç…§[å¼•è„šè¿æ¥](#å¼•è„šè¿æ¥)å›¾è¿æ¥æ‰€æœ‰ä¼ æ„Ÿå™¨

2. **å®‰è£…è¡Œç©ºæ¿å¼€å‘ç¯å¢ƒ**
   - ä¸‹è½½MindPlus

3. **é…ç½®æœåŠ¡å™¨åœ°å€**
   
   ç¼–è¾‘ `client.py` ç¬¬20è¡Œï¼š
   ```python
   SERVER_URL = "http://192.168.1.100:5000"  # æ”¹ä¸ºä½ çš„æœåŠ¡å™¨IP
   ```

4. **é…ç½®å§¿æ€æ£€æµ‹å‚æ•°**ï¼ˆæ ¹æ®å®é™…ä½©æˆ´è°ƒæ•´ï¼‰
   
   ```python
   POSTURE_AXIS = "x"              # æ£€æµ‹è½´ï¼šx, y, æˆ– z
   POSTURE_THRESHOLD = 0.49        # é˜ˆå€¼
   SITTING_DIRECTION = "less"      # æ–¹å‘ï¼šless æˆ– greater
   ```

5. **ä¸Šä¼ ä»£ç **
   - ä½¿ç”¨MindPlusæˆ–å…¶ä»–å·¥å…·ä¸Šä¼  `client.py` åˆ°è¡Œç©ºæ¿
   - ç¡®ä¿æ‰€æœ‰ä¾èµ–åº“å·²å®‰è£…

6. **è¿è¡Œç¨‹åº**
   ```bash
   python client.py
   ```

7. **éªŒè¯è¿æ¥**
   - è¡Œç©ºæ¿å±å¹•åº”æ˜¾ç¤º"è¿åŠ¨è…¿ç¯ç³»ç»Ÿ"
   - Webç•Œé¢åº”æ˜¾ç¤º"åœ¨çº¿"çŠ¶æ€
   - è¯­éŸ³åº”æ’­æŠ¥"è¿åŠ¨è…¿ç¯ç³»ç»Ÿå·²å¯åŠ¨"

### ç½‘ç»œé…ç½®

#### åŒä¸€å±€åŸŸç½‘éƒ¨ç½²

1. æœåŠ¡å™¨å’Œè¡Œç©ºæ¿è¿æ¥åŒä¸€WiFi
2. æŸ¥çœ‹æœåŠ¡å™¨IPï¼š
   - Windows: `ipconfig`
   - Linux: `ifconfig` æˆ– `ip addr`
3. åœ¨å®¢æˆ·ç«¯é…ç½®æ­¤IPåœ°å€

#### è¿œç¨‹è®¿é—®éƒ¨ç½²

1. **ä½¿ç”¨å†…ç½‘ç©¿é€ï¼ˆæ¨èæ–°æ‰‹ï¼‰**
   - ä½¿ç”¨ frpã€ngrok ç­‰å·¥å…·
   - ç¤ºä¾‹ä½¿ç”¨ngrokï¼š
   ```bash
   ngrok http 5000
   ```
   - ä½¿ç”¨ç”Ÿæˆçš„URLé…ç½®å®¢æˆ·ç«¯

2. **é…ç½®ç«¯å£è½¬å‘ï¼ˆéœ€è¦è·¯ç”±å™¨æƒé™ï¼‰**
   - åœ¨è·¯ç”±å™¨ç®¡ç†ç•Œé¢é…ç½®ç«¯å£è½¬å‘
   - è½¬å‘å¤–ç½‘ç«¯å£åˆ°æœåŠ¡å™¨çš„5000ç«¯å£
   - ä½¿ç”¨å…¬ç½‘IPè®¿é—®

---

## ä½¿ç”¨è¯´æ˜

### æ¨¡å¼åˆ‡æ¢

**ç¡¬ä»¶æ“ä½œï¼š**
- **çŸ­æŒ‰æŒ‰é’®**ï¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªæ¨¡å¼
- **é•¿æŒ‰æŒ‰é’®**ï¼ˆ1.5ç§’ï¼‰ï¼šè¿›å…¥/é€€å‡ºç´§æ€¥æ¨¡å¼

**Webæ“ä½œï¼š**
- ç‚¹å‡»ç•Œé¢ä¸Šçš„æ¨¡å¼æ»‘å—åˆ‡æ¢æ¨¡å¼

### å§¿æ€ç›‘æµ‹

ç³»ç»Ÿè‡ªåŠ¨æ£€æµ‹ç”¨æˆ·å§¿æ€ï¼š
- **åå§¿**ï¼šæŒç»­åå§¿è¶…è¿‡è®¾å®šæ—¶é—´ä¼šè¯­éŸ³æé†’
- **ç«™å§¿**ï¼šæ­£å¸¸ç«™ç«‹çŠ¶æ€
- **è¿åŠ¨ä¸­**ï¼šæ£€æµ‹åˆ°è¿åŠ¨æ—¶è‡ªåŠ¨è®°å½•
- **è·Œå€’**ï¼šè§¦å‘ç´§æ€¥è­¦æŠ¥

### è¿åŠ¨æ•°æ®

**æ­¥æ•°ç»Ÿè®¡ï¼š**
- åŸºäºåŠ é€Ÿåº¦è®¡æ•°æ®çš„æ­¥æ€è¯†åˆ«
- è‡ªåŠ¨è¿‡æ»¤æ— æ•ˆéœ‡åŠ¨

**é…é€Ÿè®¡ç®—ï¼š**
- å…¬å¼ï¼šé…é€Ÿ = è¿åŠ¨æ—¶é•¿(åˆ†é’Ÿ) / (æ­¥æ•° Ã— 0.0007 å…¬é‡Œ)
- å®æ—¶æ˜¾ç¤ºåœ¨å±å¹•ä¸Š

**å‡ç¢³é‡ï¼š**
- æ­¥è¡Œï¼š0.14g COâ‚‚/æ­¥
- è‡ªåŠ¨ç´¯è®¡å¹¶åŒæ­¥åˆ°æœåŠ¡å™¨

### ä¹…åæé†’

1. **é»˜è®¤è®¾ç½®**ï¼š60åˆ†é’Ÿ
2. **è‡ªå®šä¹‰è®¾ç½®**ï¼š
   - Webç•Œé¢ â†’ è®¾ç½®æŒ‰é’® â†’ ä¿®æ”¹ä¹…åæé†’æ—¶é•¿
   - ä¿å­˜åç«‹å³ç”Ÿæ•ˆ
3. **æé†’æ–¹å¼**ï¼š
   - è¯­éŸ³æ’­æŠ¥ï¼š"æ‚¨å·²ä¹…åXXåˆ†é’Ÿï¼Œå»ºè®®èµ·èº«æ´»åŠ¨"
   - å±å¹•æ˜¾ç¤ºè¿›åº¦æ¡

### æ¶ˆæ¯æ¨é€

ä»Webç•Œé¢å‘é€æ¶ˆæ¯åˆ°è®¾å¤‡ï¼š
1. ç‚¹å‡»"å‘é€æ¶ˆæ¯"æŒ‰é’®
2. è¾“å…¥æ¶ˆæ¯å†…å®¹
3. è®¾å¤‡å°†æ˜¾ç¤ºæ»šåŠ¨æ¶ˆæ¯å¹¶è¯­éŸ³æ’­æŠ¥

### æ•°æ®æŸ¥çœ‹

**å®æ—¶æ•°æ®ï¼š**
- è®¾å¤‡çŠ¶æ€ã€ç¯å¢ƒæ•°æ®ã€è¿åŠ¨ç»Ÿè®¡
- åˆ·æ–°é¢‘ç‡ï¼š2ç§’

**å†å²æ•°æ®ï¼š**
- ç‚¹å‡»"å†å²æ•°æ®"æ ‡ç­¾
- æŸ¥çœ‹7å¤©æˆ–è‡ªå®šä¹‰å¤©æ•°çš„è¿åŠ¨è¶‹åŠ¿
- å›¾è¡¨æ˜¾ç¤ºè¿åŠ¨æ—¶é•¿ã€æ´»è·ƒå°æ—¶æ•°

**è¿åŠ¨è®°å½•ï¼š**
- æ¯æ¬¡è¿åŠ¨ç»“æŸè‡ªåŠ¨ä¿å­˜è®°å½•
- åŒ…å«ï¼šæ—¥æœŸã€æ¨¡å¼ã€æ—¶é•¿ã€é…é€Ÿç­‰

---

## APIæ–‡æ¡£

### åŸºæœ¬ä¿¡æ¯

- **Base URL**: `http://your-server:5000`
- **Content-Type**: `application/json`

### ç«¯ç‚¹åˆ—è¡¨

#### 1. è·å–è®¾å¤‡çŠ¶æ€

```http
GET /api/status
```

**æŸ¥è¯¢å‚æ•°ï¼š**
- `days` (å¯é€‰): è·å–å†å²æ•°æ®å¤©æ•°ï¼Œé»˜è®¤7

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "mode": 0,
  "temperature": 25.3,
  "humidity": 55.2,
  "brightness": 128,
  "posture": "sitting",
  "pace": 0,
  "pace_str": "6'30\"",
  "step": 5280,
  "carbon_reduce": 0.7392,
  "emergency": false,
  "sport_time_today": 45,
  "activity_hours": [9, 10, 14, 15],
  "sitting_duration": 3600,
  "sport_duration": 2700,
  "message_showing": false,
  "last_update": "2024-01-15 14:30:25",
  "online": true,
  "carbon_reduce_all": 15.4821
}
```

#### 2. æ›´æ–°è®¾å¤‡çŠ¶æ€

```http
POST /api/status
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "mode": 1,
  "temperature": 25.0,
  "humidity": 50.0,
  "brightness": 100,
  "posture": "standing",
  "pace": 0,
  "pace_str": "--'--\"",
  "step": 0,
  "carbon_reduce": 0.0,
  "emergency": false,
  "sport_time_today": 0,
  "activity_hours": [],
  "sitting_duration": 0,
  "sport_duration": 0,
  "message_showing": false
}
```

**å“åº”ï¼š**
```json
{
  "status": "ok",
  "commands": [],
  "sitting_remind_duration": 3600
}
```

#### 3. å‘é€æ§åˆ¶å‘½ä»¤

```http
POST /api/control
```

**è¯·æ±‚ä½“ç¤ºä¾‹ï¼š**

æ¨¡å¼åˆ‡æ¢ï¼š
```json
{
  "command": "change_mode",
  "mode": 1
}
```

äº®åº¦è°ƒèŠ‚ï¼š
```json
{
  "command": "set_brightness",
  "value": 200
}
```

#### 4. å‘é€æ¶ˆæ¯

```http
POST /api/message
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "message": "è®°å¾—è¡¥å……æ°´åˆ†ï¼"
}
```

#### 5. è·å–ç´§æ€¥è®°å½•

```http
GET /api/emergency
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
[
  {
    "time": "2024-01-15 12:30:45",
    "message": "æ£€æµ‹åˆ°æ‘”å€’ï¼Œéœ€è¦ç´§æ€¥æ•‘åŠ©",
    "location": "æœªçŸ¥",
    "resolved": false
  }
]
```

#### 6. æ ‡è®°ç´§æ€¥æƒ…å†µå·²è§£å†³

```http
PUT /api/emergency/<index>
```

**å“åº”ï¼š**
```json
{
  "status": "ok"
}
```

#### 7. è·å–å†å²æ•°æ®

```http
GET /api/history?days=7
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "2024-01-15": {
    "sport_time": 45,
    "activity_hours": [9, 10, 14],
    "carbon_reduce": 0.7392,
    "step": 5280
  },
  "2024-01-14": {
    "sport_time": 30,
    "activity_hours": [15, 16],
    "carbon_reduce": 0.4928,
    "step": 3520
  }
}
```

#### 8. è·å–è¿åŠ¨è®°å½•

```http
GET /api/sport_records
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
[
  {
    "time": "2024-01-15 14:30:00",
    "mode": "è¿åŠ¨æ¨¡å¼",
    "duration": 2700,
    "pace": "6'30\"",
    "steps": 5280,
    "carbon_reduce": 0.7392
  }
]
```

#### 9. æ·»åŠ è¿åŠ¨è®°å½•

```http
POST /api/sport_records
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "time": "2024-01-15 14:30:00",
  "mode": "è¿åŠ¨æ¨¡å¼",
  "duration": 2700,
  "pace": "6'30\"",
  "steps": 5280,
  "carbon_reduce": 0.7392
}
```

#### 10. è·å–è®¾ç½®

```http
GET /api/settings
```

**å“åº”ï¼š**
```json
{
  "sitting_remind_duration": 3600
}
```

#### 11. æ›´æ–°è®¾ç½®

```http
POST /api/settings
```

**è¯·æ±‚ä½“ï¼š**
```json
{
  "sitting_remind_duration": 7200
}
```

---

## æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

#### 1. è®¾å¤‡æ˜¾ç¤ºç¦»çº¿

**å¯èƒ½åŸå› ï¼š**
- ç½‘ç»œè¿æ¥é—®é¢˜
- æœåŠ¡å™¨åœ°å€é…ç½®é”™è¯¯
- æœåŠ¡å™¨æœªå¯åŠ¨

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥æœåŠ¡å™¨æ˜¯å¦è¿è¡Œ
curl http://localhost:5000/api/status

# æ£€æŸ¥è¡Œç©ºæ¿ç½‘ç»œ
# åœ¨è¡Œç©ºæ¿ä¸ŠpingæœåŠ¡å™¨IP

# æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
# Windows: å…è®¸5000ç«¯å£é€šè¿‡é˜²ç«å¢™
# Linux: sudo ufw allow 5000
```

#### 2. æ¸©æ¹¿åº¦æ˜¾ç¤ºå¼‚å¸¸

**å¯èƒ½åŸå› ï¼š**
- DHT11ä¼ æ„Ÿå™¨è¿æ¥æ¾åŠ¨
- ä¼ æ„Ÿå™¨æ•…éšœ

**è§£å†³æ–¹æ¡ˆï¼š**
- æ£€æŸ¥P23å¼•è„šè¿æ¥
- æ›´æ¢ä¼ æ„Ÿå™¨æµ‹è¯•
- æŸ¥çœ‹ä¸²å£è¾“å‡ºæ—¥å¿—

#### 3. æ­¥æ•°ç»Ÿè®¡ä¸å‡†ç¡®

**å¯èƒ½åŸå› ï¼š**
- åŠ é€Ÿåº¦è®¡çµæ•åº¦è®¾ç½®ä¸å½“
- è®¾å¤‡ä½©æˆ´ä½ç½®ä¸æ­£ç¡®

**è§£å†³æ–¹æ¡ˆï¼š**
- è°ƒæ•´æ­¥æ•°æ£€æµ‹é˜ˆå€¼
- ç¡®ä¿è®¾å¤‡ç¨³å®šä½©æˆ´åœ¨è„šè¸

#### 4. è¯­éŸ³æ’­æŠ¥æ— å£°éŸ³

**å¯èƒ½åŸå› ï¼š**
- TTSæ¨¡å—æœªæ­£ç¡®åˆå§‹åŒ–
- I2Cè¿æ¥é—®é¢˜

**è§£å†³æ–¹æ¡ˆï¼š**
```python
# æ£€æŸ¥TTSåˆå§‹åŒ–ä»£ç 
# ç¡®è®¤è¯­éŸ³æ¨¡å—I2Cåœ°å€
# æ£€æŸ¥éŸ³é‡è®¾ç½®
```

#### 5. Webç•Œé¢æ— æ³•è®¿é—®

**å¯èƒ½åŸå› ï¼š**
- æœåŠ¡å™¨æœªå¯åŠ¨
- ç«¯å£è¢«å ç”¨
- é˜²ç«å¢™é˜»æ­¢

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -an | grep 5000

# æ›´æ”¹ç«¯å£
# åœ¨server.pyæœ€åä¸€è¡Œä¿®æ”¹portå‚æ•°

# å…³é—­é˜²ç«å¢™æµ‹è¯•
# Windows: æ§åˆ¶é¢æ¿ â†’ é˜²ç«å¢™
# Linux: sudo ufw disable
```

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—ï¼š

```python
# server.py æœ€åä¸€è¡Œ
app.run(host='0.0.0.0', port=5000, debug=True, threaded=True)
```

æŸ¥çœ‹å®¢æˆ·ç«¯æ—¥å¿—ï¼š
```bash
# è¡Œç©ºæ¿ä¸²å£ç›‘è§†å™¨æŸ¥çœ‹å®æ—¶æ—¥å¿—
```

---

## é¡¹ç›®ç»“æ„

```
smart-sports-anklet/
â”œâ”€â”€ README.md                 # é¡¹ç›®æ–‡æ¡£
â”œâ”€â”€ requirements.txt          # Pythonä¾èµ–
â”œâ”€â”€ LICENSE                  # å¼€æºè®¸å¯è¯
â”œâ”€â”€ server.py              # Flaskåç«¯æœåŠ¡å™¨
â”œâ”€â”€ client.py              # è¡Œç©ºæ¿å®¢æˆ·ç«¯ç¨‹åº
â”œâ”€â”€ control.html             # Webæ§åˆ¶ç•Œé¢
â””â”€â”€ data/                    # æ•°æ®ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
    â”œâ”€â”€ emergency.json       # ç´§æ€¥è®°å½•
    â”œâ”€â”€ history.json         # å†å²æ•°æ®
    â”œâ”€â”€ sport_records.json   # è¿åŠ¨è®°å½•
    â””â”€â”€ settings.json        # ç³»ç»Ÿè®¾ç½®
```

---

## è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿æ‰€æœ‰å½¢å¼çš„è´¡çŒ®ï¼

### å¦‚ä½•è´¡çŒ®

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. å¼€å¯ Pull Request

### ä»£ç è§„èŒƒ

- éµå¾ª PEP 8 Pythonä»£ç è§„èŒƒ
- æ·»åŠ å¿…è¦çš„æ³¨é‡Šå’Œæ–‡æ¡£å­—ç¬¦ä¸²
- ç¡®ä¿ä»£ç é€šè¿‡æµ‹è¯•

### æŠ¥å‘Šé—®é¢˜

å¦‚æœå‘ç°Bugæˆ–æœ‰åŠŸèƒ½å»ºè®®ï¼Œè¯·[åˆ›å»ºIssue](https://github.com/binglang001/smart-sports-anklet/issues)ã€‚

---

## å¼€å‘è·¯çº¿å›¾

- [x] åŸºç¡€è¿åŠ¨ç›‘æµ‹åŠŸèƒ½
- [x] Webæ§åˆ¶ç•Œé¢
- [x] æ•°æ®æŒä¹…åŒ–å­˜å‚¨
- [x] è·Œå€’æ£€æµ‹å’Œç´§æ€¥è­¦æŠ¥
- [ ] ç§»åŠ¨ç«¯APP
- [ ] æ•°æ®äº‘åŒæ­¥
- [ ] AIè¿åŠ¨å»ºè®®
- [ ] å¤šè®¾å¤‡æ”¯æŒ
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] ç¤¾äº¤åˆ†äº«åŠŸèƒ½

---

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶ã€‚

---

## è‡´è°¢

- æ„Ÿè°¢[DFRobot](https://www.dfrobot.com/)æä¾›çš„ç¡¬ä»¶æ”¯æŒ
- æ„Ÿè°¢æ‰€æœ‰è´¡çŒ®è€…çš„ä»˜å‡º

---

## è”ç³»æ–¹å¼

- é¡¹ç›®ä¸»é¡µï¼š[https://github.com/binglang001/smart-sports-anklet](https://github.com/binglang001/smart-sports-anklet)
- é—®é¢˜åé¦ˆï¼š[Issues](https://github.com/binglang001/smart-sports-anklet/issues)
- é‚®ç®±ï¼šlianbingyu_v2@163.com

---

<div align="center">

**å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™æˆ‘ä»¬ä¸€ä¸ª â­ï¸**

Made with â¤ï¸ by [binglang001]

</div>